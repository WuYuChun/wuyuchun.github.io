# 编译系统


## CMake


递归收集当前目录下所有文件
```
#file(GLOB ALL_FILES *.cpp)
AUX_SOURCE_DIRECTORY(. ALL_FILES)
FOREACH (FILE ${ALL_FILES})
    MESSAGE(STATUS ${FILE})
    STRING(REPLACE "./" "" LIB_NAME ${FILE})
    STRING(REPLACE ".cpp" "" LIB_NAME ${LIB_NAME})
    message(STATUS ${LIB_NAME})
    add_executable(${LIB_NAME} ${FILE} ${test})
    target_link_libraries(${LIB_NAME} PUBLIC Threads::Threads)
ENDFOREACH ()

file(GLOB_RECURSE  MathFiles *.cxx *.h)  # 收集当前目录下所有文件
foreach(rmFile ${MathFiles})
    string(REGEX MATCH ".*/MakeTable.cxx" needRemoveFile ${rmFile})
    if(needRemoveFile)
        list(REMOVE_ITEM MathFiles ${needRemoveFile})
    endif(needRemoveFile)
endforeach(rmFile ${MathFiles})
message(STATUS ${MathFiles})    # 打印文件列表
add_library(MathFunctions ${MathFiles})
```


使用cmake编译cuda相关的程序的时候

```
# 出现的问题
cmake Error:Files to be generated by multiple differet commands:xxxxxx
```
原因就是在于,在**cuda_add_executable这个命令中多次引用param.cu这个文件**

```
set(tmp_file param.cu)
cuda_add_executable(test main.cpp param.cu ${tmp_file})
```
## connan