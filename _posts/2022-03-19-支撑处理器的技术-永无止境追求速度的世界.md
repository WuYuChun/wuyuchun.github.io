# 支撑处理器的技术-永无止境追求速度的世界



## 处理器与计算机的基础

- 闪存
  - 使用MLC（Multi Level Cell）技术，一个存储单元可以取4个值，0,1,2,3，但是擦写次数过多，导致存储的值变化很大。
  - 使用SLC（Single Level Cell）技术，2值存储，擦写次数很多的服务器中内置都是SLC的闪存盘
- 提升性能的三大支柱
  - 提高时钟频率
  - 并行处理
  - 功能扩展
- 指令架构：详细地规定了处理器应当支持哪些指令，各个指令应执行什么操作等



## 处理器的发展

- 微架构的发展之道
  - 流水线处理
  - 运算器高速化
  - RISC和CISC
  - 超标量执行
  - 乱序执行
  - 分支预测
  - 缓存
  - 多核心
- 处理器的历史：让指令更快执行的奋斗史



## 面向程序员的处理器架构

- 指令流水线的3中冒险
  - 结构冒险
    - 多条指令需要使用内存，寄存器，运算单元等只有一个的资源，就会出现资源呢冲突问题
    - 解决办法：让高优先级 的指令使用资源：流水线气泡，也叫流水线停顿
    - 增加资源
  - 数据冒险
    - 下一个运算指令需要用到上一个指令的运算结果
    - 解决办法：软件流水线处理
  - 控制冒险：如果无法确定跳转的地址，就无法开始下一个指令的获取
- 高速缓存的构造
  - 内存与缓存之间以缓存线为单位传送数据
    - 当处理器请求从某一个地址加载数据时，先会查看缓存中是否存在
    - 当处理器请求向某一个地址存储数据时，会先从内存该地址中读入数据缓存中，再把存储的数据 写入到缓存中，在从缓存中写入内存，保持数据的一致性
  - 这样双方的数据竞争同一缓存线，而造成频繁替换的情况称为抖动
  - 编程时善用缓存
- 定长指令和变长指令
  - 指令译码困难：如果不知道第一条指令的长度，就没有办法译码下一条指令------CISC指令问题
  - 流水线执行困难
- 超标量执行的原理
  - 一个 周期内并行执行多条指令的处理器：超标量处理器
- 乱序执行的原理
  - 打乱机器指令的顺序
  - 存在问题：
    - 反向依赖：存在反向依赖时，调整指令的执行顺序，会导致无法得到正确结果
  - 保证正确的中断
  - 重命名主要目的：消除反向依赖，增加恢复功能后，还能取消执行过的指令，正确实现中断
- 分支预测的原理
- 页式管理-现在主流的内存管理方式
  - 在X86处理器中，页的大小为4KB，而占用100MB内存空间的程序需要25000页

## 虚拟化支持

- 实现虚拟化，问题最大的就是内存访问和管理
  - 程序访问内存，操作系统会进行地址转换，接着VMM会把操作系统的地址，再一次进行转换，才能到真正的内存
- VMM要给Guest OS提供“独立的内存空间”，而且Guest OS认为的物理地址实际上是各个Guest OS的虚拟物理地址，VMM会利用自己的页表将虚拟物理地址转换成实际的物理地址



## 多处理器的出现和普及



## 处理器周边技术



- 内存技术
  - DRAM



## GPU与超并行处理



- 减少数据传输和程序启动的额外开销
- 有效运行Warp内所有线程很重要



## 处理器的发展趋势

- 缩放定律
- 如果继续降低电源电压，那么状态切换的耗电量会降低，但漏电流的增加反而会导致整体耗电量上升













