# 联邦学习笔记-Federated learning

> 如何在保证本地训练数据不公开的前提下，实现多个数据拥有者协同训练一个共享的机器学习模型？

联邦学习，它主要从技术维度出发，重点研究其中的隐私保护和数据安全问题。

联邦学习如何保护隐私和数据安全？-》它包括两个过程，**模型训练和模型推理**。在模型训练阶段，模型相关信息可以各方之间交换，但数据不能交换。因此各个站点的数据将受到保护，在模型推理阶段，训练好的联邦学习模型可以置于联邦学习系统的各参与方。

----

四种联邦学习的基本类型：

- 横向联邦学习
- 纵向联邦学习
- 联邦迁移学习
- 联邦强化学习

联邦学习发展的动机：

✅保护用户隐私和数据安全

✅最大化地利用云系统下终端设备的计算能力

推进联邦学习，需要以下多个学科领域合作：

✔机器学习算法

✔分布式机器学习

✔密码学与安全

✔隐私数据保护挖掘

✔博弈论与经济学原理

✔激励机制设计

> Federated AI Technology Enable, FATA 第一个工业级联邦学习开源框架

----

人工智能面临的挑战

💪人们对于用户隐私和数据保护安全的关注度不断在提升

💪各方协同分享处理大数据的益处并不明显：随着物联网和边缘计算，大数据分布在许多方面

联邦学习的核心思想：**由每一个拥有数据源的组织训练一个模型，之后让各个组织在各自的模型上彼此交流沟通，最终通过模型聚合得到一个全局模型，各个组织交换模型信息的过程将会被精心设计，使得没有组织能够猜测到其他组织的任何隐私信息。同时，当构建全局模型时，各数据源仿佛已经整合在一起。**

联邦学习具有以下特征：

- 有两个或以上的参与方构建一个共享的机器学习模型
- 每一个参与方的数据都不会离开该参与方
- 联邦学习模型相关信息能够以加密方式在各方之间进行传输和交换
- 联邦学习模型的性能要能够充分逼近理想模型（将所有数据集中在一起并训练获得的机器学习模型）性能

> 同态加密？指的是什么

![客户和服务器架构](/images/posts/2021-11-08-联邦学习01.jpg)

![对等网络结构](/images/posts/2021-11-08-联邦学习02.jpg)

------------------

## 横向联邦学习

$$
x_i = x_j, y_i = y_j, I_i \neq I_j , \Delta D_i,D_j, i \neq j
$$

按照不同样本进行划分



![横向联学习](/images/posts/2021-11-08-联邦学习03.jpg)

![](/images/posts/2021-11-08-联邦学习07.jpg)

算法改进：

- 通信效率的提升
  - 压缩模型参数更新
  - 结构化模型参数更新
- 参与方选择



## 纵向联邦学习

$$
x_i \neq x_j, y_i \neq y_j, I_i = I_j , \Delta D_i,D_j, i \neq j
$$

![](/images/posts/2021-11-08-联邦学习11.jpg)

按照不同的标签进行划分

![](/images/posts/2021-11-08-联邦学习04.jpg)

## 联邦迁移学习

迁移学习是一种跨领域知识迁移提供解决方案的学习技术

**迁移学习的本质是发现资源丰富源域和资源稀缺的目标域之间的不变性，并利用该不变性在两个领域之间传输知识**

基于迁移学习的方法分为三类：

- 基于实例的迁移
- 基于特征的迁移
- 基于模型的迁移



![](/images/posts/2021-11-09-联邦学习05.jpg)

-----

|                                | 安全威胁       | 攻击模式                             | 防御方法                             |
| ------------------------------ | -------------- | ------------------------------------ | ------------------------------------ |
| PPML（面向隐私保护的机器学习） | 隐私性、机密性 | 重构攻击、模型反演攻击、成员推理攻击 | 安全多方计算、**同态加密**、差分隐私 |
| 安全机器学习                   | 完整性、可用性 | 投毒攻击、对抗攻击、询问攻击         | 防御精馏、对抗训练、正则化           |

---

分布式机器学习

![分布式机器学习系统演示](/images/posts/2021-12-08-联邦学习06.jpg)

> DML, 文献分布式机器学习：算法、理论与实践 parallel and distributed deep learning: A surver

> 最广泛的DML数据处理系统---》Spark MLlib

大规模机器学习存在的挑战：

1. 内存短缺，数据太多放不下
2. 不合理的训练实践

DML的方案：

🚩数据并行：把数据划分，并行训练同一个模型

1. 同步训练
2. 异步训练

🚩模型并行：把模型分割不同部分，放置在不同的计算节点

🚩图并行

🚩任务并行

🚩混合并行

🚩交叉并行

隐私保护方法：

1. 模糊处理
2. 密码学方法

> 由于计算效率和实现的便捷性,基于模糊的隐私保护方法在基于隐私DML系统中普遍使用,但是随即扰动影响了数据精度和模型性能.密码学不需要牺牲精度和模型性能,但是需要更多的额外计算.



## 联邦学习的奖励机制



- 平等
- 边际收益
- 边际损失



推荐模型：

- 协同过滤
- 基于内容的推荐系统
- 基于模型的推荐系统
- 混合推荐系统



## 强化学习

强化学习是机器学习的一个分支点

强化学习系统：

- 智能体
- 环境
- 策略
- 奖励
- 价值函数
- 可选的环境模型



## 应用前景

- 金融
- 医疗
- 教育
- 城市计算
- 边缘计算
  - ![](/images/posts/2021-11-08-联邦学习12.jpg)
- 区块链